!function(t){function e(i){if(n[i])return n[i].exports;var a=n[i]={exports:{},id:i,loaded:!1};return t[i].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var i=n(1),a=n(2);n(4);void 0===window.requestAnimationFrame?document.write("浏览器版本太低 ,请选择谷歌浏览器，火狐浏览器，IE10+"):i.whenReady(function(){var t=document.getElementById("screen"),e=document.getElementById("gameWrap"),n=document.getElementById("dialog"),r=1,o=parseInt(i.getStyles(t,"width"));i.setStyles(e,"height:"+Math.round(o*r)+"px;");var s=null;window.onresize=function(n){var a=parseInt(i.getStyles(t,"width"));return o!=a&&(o=a,s&&window.clearTimeout(s),void(s=window.setTimeout(function(){i.setStyles(e,"height:"+Math.round(a*r)+"px;")},500)))},new a(t,n)})},function(t,e){"use strict";t.exports={getStyles:function(t,e){return window.getComputedStyle?window.getComputedStyle(t,null).getPropertyValue(e):window.currentStyle?window.currentStyle(t).getAttribute(e):void 0},setStyles:function(t,e){var n=t.style.cssText;t.style.cssText=";"===n.substr(-1,1)?n+e:n+";"+e},type:function(t){return Object.prototype.toString.call(t).split(" ")[1].slice(0,-1)},randf:function(t,e){return Math.random()*(e-t)+t},randi:function(t,e){return Math.round(this.randf(t,e))},max_array:function(t){var e=0;for(var n in t)t[n]>e&&(e=t[n]);return e},randomColor:function(){var t=this.randi(0,255),e=this.randi(0,255),n=this.randi(0,255);return t+","+e+","+n},getInner:function(){var t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;return{height:t,width:e}},isWeiXin:function(){var t=window.navigator.userAgent.toLowerCase();return"micromessenger"==t.match(/MicroMessenger/i)},updateUrl:function(t,e){var e=(e||"t")+"=",n=new RegExp(e+"\\d+");t=t.search(n)===-1?t+"?"+e+(new Date).getTime():t.replace(n,e+(new Date).getTime()),window.location.replace(t)},insertRule:function(t,e,n){if(t.insertRule){var i=e+"{"+n+"}";t.insertRule(i,t.cssRules.length)}else t.addRule&&t.addRule(e,n,t.rules.length)},whenReady:function(){var t=!1,e=[],n=function(n){if(!t){var i=n||window.event;if("readystatechange"!==i.type||"complete"===document.readyState){for(var a=0;a<e.length;++a)e[a].call(document);t=!0,e=null}}};return document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),document.addEventListener("readystatechange",n,!1),document.addEventListener("load",n,!1)):document.attachEvnet&&(document.attachEvent("onreadystatechange",n),document.attachEvent("onload",n)),function(n){t?n.call(document):e.push(n)}}(),animation:function(t,e,n){if("function"!=typeof e)throw new Error(e.toString()+"is not a function!");var t="Number"===this.type(t)?t:1e3,i=null,n="Object"===this.type(n)?n:{},a=null,r=0,o=this,s=function(c){null===a&&(a=c);var d=c-a;d-r>=t&&(r=d,i=e(n)),void 0==i?o.animation.cancelAnimaId=requestAnimationFrame(s):i.next&&"Function"===o.type(i.next)&&i.next()};requestAnimationFrame(s)}}},function(t,e,n){"use strict";function i(t,e){this.screen=t,this.dialog=e,this.data={},this.grenadeData={},this.row=16,this.col=16,this.grenadeTotal=40,this.gameOver=!1,this.flag=40,this.startTime=null,this.timer=null,this.init(),this.initEvent(),this.clickDone={},this.flagData={},this.initRank()}var a=n(1),r=n(3);i.prototype={init:function(){for(var t=this.grenadeTotal,e=0;e<t;++e)new r(this);for(var n=this.data,e=0;e<this.row;++e)for(var i=0;i<this.col;++i){var a=this.checkIdentify(e,i);a&&(n[a]={row:e,col:i,count:0})}this.updateCount()},initRank:function(){var t=document.getElementById("finish_rank"),e=window.localStorage.getItem("FINISH_TIME_RANK")||"???";e=e.split(",");for(var n=e.length,i="",a=["icon-guanjun","icon-crown","icon-zuanshi","icon-wangguan","icon-rank-2"],r=0;r<n;++r)i+='<li><span><svg class="icon" aria-hidden="true"><use xlink:href="#'+a[r]+'"></use></svg></span>'+e[r]+"秒</li>";t.innerHTML=i},updateCount:function(){var t=this.data,e=this.grenadeData;for(var n in e){var i=e[n].row,a=e[n].col;this.map(i,a,function(e,n){var i=e+"&"+n;t[i]&&++t[i].count})}},map:function(t,e,n){for(var i=Math.max(t-1,0),a=Math.max(e-1,0),r=Math.min(t+2,this.row),o=Math.min(e+2,this.col),s=[],c=i;c<r;++c)for(var d=a;d<o;++d)if("function"==typeof n){var l=n.call(this,c,d);l&&s.push(l)}return s},register:function(t,e){this.grenadeData[t]=e},checkIdentify:function(t,e){var n=t+"&"+e;return!this.grenadeData[n]&&n},messagebox:function(t,e,n){var e=e||300,i=this;if(window.setTimeout(function(){var e=this.dialog.getElementsByTagName("span")[0];e.innerHTML=t,a.setStyles(this.dialog,"visibility:visible;")},e),"function"==typeof n){var r=this.dialog.getElementsByTagName("button")[0];r.onclick=function(){n.call(i),r.onclick=null}}},stop:function(){this.timer&&window.clearInterval(this.timer),this.startTime=null},save:function(t){var e="FINISH_TIME_RANK",n=window.localStorage.getItem(e);n=n?n.split(","):[],n.push(t),n.sort(function(t,e){return t-e}),n.length>3&&n.pop(),window.localStorage.setItem(e,n)},initEvent:function(){var t=this;document.getElementById("restart").addEventListener("click",function(){a.isWeiXin()?a.updateUrl(window.location.href):history.go(0)}),document.getElementById("done").addEventListener("click",function(){t.gameOver||t.startTime&&(t.checkDone()?t.messagebox("(^_^) ,赢得漂亮!",300,function(){a.setStyles(this.dialog,"visibility:hidden"),this.save(+(((new Date).getTime()-this.startTime)/1e3)),window.history.go(0)}):(t.messagebox("(T_T) ,蓝瘦香菇!",300,function(){a.setStyles(this.dialog,"visibility:hidden")}),t.account()))}),document.getElementById("startToggler").addEventListener("click",function(){if(!t.gameOver){t.startTime=(new Date).getTime(),this.classList.contains("disable")||this.classList.add("disable");var e=document.getElementById("timer").getElementsByTagName("time")[0];t.timer=window.setInterval(function(){e.innerHTML=t.dateFormat((new Date).getTime()-t.startTime)},1e3)}}),this.screen.addEventListener("click",function(e){function n(e,i){if(!t.clickDone[e+"&"+i]){var r=t.map(e,i,function(e,n){var i=e+"&"+n,r=t.data[i].count;if(0==r){if(d[i])return;if(t.flagData[i])return;return a.setStyles(t.screen.children[e].children[n],"background-color:#dfdfdf"),d[i]=!0,{row:e,col:n}}if(0!==r){if(t.flagData[i])return;d[i]=!0,t.screen.children[e].children[n].innerHTML=r}});for(var o in r)n(r[o].row,r[o].col)}}if(!t.gameOver&&t.startTime){var i=e||window.event,r=i.target||i.srcElement;if(r!==t.screen){var o=r.parentNode,s=o.getAttribute("data-index")-1,c=r.getAttribute("data-index")-1;if(!t.clickDone[s+"&"+c]&&!t.flagData[s+"&"+c]){var d={};if(t.checkIdentify(s,c)){var l=t.data[s+"&"+c];if(0==l.count){n(s,c);for(var u in d)t.clickDone[u]=d[u]}else d[s+"&"+c]=!0,t.clickDone[s+"&"+c]=!0,r.innerHTML=l.count}else t.account(),t.messagebox("Game Over",500,function(){a.setStyles(this.dialog,"visibility:hidden")})}}}}),this.screen.addEventListener("contextmenu",function(e){if(!t.gameOver&&t.startTime){var n=e||window.event;n.preventDefault(),n.stopPropagation();var i=n.target||n.srcElement,a=i.parentNode,r=a.getAttribute("data-index")-1,o=i.getAttribute("data-index")-1,s=r+"&"+o;if(i.classList.contains("flag"))++t.flag,i.classList.remove("flag"),delete t.flagData[s];else{if(t.flag<1)return;if(t.clickDone[s])return;--t.flag,i.classList.add("flag"),t.flagData[s]=!0}document.getElementById("flagCount").getElementsByTagName("span")[0].innerHTML=t.flag+"/"+t.grenadeTotal}})},dateFormat:function(t){var e=t/1e3,n=Math.floor(e/60);return n>59&&this.account(),n=n<10?"0"+n:n,e%=60,e=e<10?"0"+parseInt(e,10):parseInt(e,10),n+":"+e},checkDone:function(){for(var t in this.grenadeData)if(!this.flagData[t])return!1;return!0},account:function(){var t=this.data,e=this.grenadeData;for(var n in e){var i=e[n],a=this.screen.children[i.row].children[i.col];a.classList.add("grenade")}for(var r in t){var o=r.split("&"),s=parseInt(o[0]),c=parseInt(o[1]),d=t[r];0!==d.count&&(this.screen.children[s].children[c].innerHTML=d.count)}this.gameOver=!0,this.stop()}},t.exports=i},function(t,e,n){"use strict";function i(t){this.screen=t,this.row=0,this.col=0,this.init()}var a=n(1);i.prototype={init:function(){function t(){var e=a.randi(0,15),n=a.randi(0,15),i=this.screen.checkIdentify(e,n);i?(this.row=e,this.col=n,this.identify=i,this.screen.register(i,this)):t.call(this)}t.call(this)}},t.exports=i},function(t,e){}]);