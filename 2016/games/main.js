!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var r=n(1),o=(n(5),n(2));void 0===window.requestAnimationFrame?document.write("浏览器版本太低 ,请选择谷歌浏览器，火狐浏览器，IE10+"):document.onreadystatechange=function(){function t(){var t,r=o.getInner(),a=Math.min(r.width,480),s=r.height,c=3,u=document.getElementById("gameWrap");t=Math.ceil(a/(12+c))>Math.ceil(s/(21+c))?Math.ceil(s/(21+c)):Math.ceil(a/(12+c));var h=t*(21+c),p=t*(12+c);if(p<165)return document.write("屏幕尺寸太小"),!1;var f=(a-p)/2,g=(s-h)/2,m=13*t+1,v=21*t+1;o.setStyles(n,"height:"+2*t+"px;width:98%;font-size:"+t+"px;line-height:1px"),o.setStyles(d,"margin-top:"+1.5*t+"px;height:"+(1.5*t+2)+"px"),o.setStyles(i,"margin-top:"+(3*t+20)+"px"),o.setStyles(d.getElementsByTagName("label")[0],"font-size:"+t/2+"px;height:"+t/1.5+"px;"),o.setStyles(document.getElementById("setting"),"width:"+(p-m+(t-2))+"px;height:"+v+"px"),o.setStyles(e,"width:"+m+"px;height:"+v+"px;left:-"+t+"px"),o.setStyles(l,"height:"+10*t+"px;top:"+(h-10*t-80)/2+"px;"),o.setStyles(l.getElementsByTagName("button")[0],"height:"+2*t+"px;bottom:"+t+"px;font-size:"+t/1.5+"px;"),o.setStyles(document.getElementById("copyright"),"width:"+p+"px");var w=document.styleSheets,y=w[w.length-1];return y.insertRule?(y.insertRule(".unit{width:"+t+"px;height:"+t+"px;}",y.length),y.insertRule("#guide button{margin-top:5px;font-size:"+t+"px;height:"+2*t+"px;}",y.length),y.insertRule("#randomColorToggler,#restart,#pauseToggler{height:"+t+"px;font-size:"+t/1.5+"px;margin-top:"+1.5*t+"px;}",y.length)):y.addRule&&(y.addRule(".unit","width:"+t+"px;height:"+t+"px;",y.length),y.addRule("#guide button","margin-top:5px;font-size:"+t+"px;height:"+2*t+"px;",y.length),y.insertRule("#randomColorToggler,#restart,#pauseToggler","height:"+t+"px;font-size:"+t/1.5+"px;margin-top:"+1.5*t+"px;",y.length)),o.setStyles(u,"width:"+p+"px;height:"+h+"px;top:"+g+"px;left:"+f+"px;display:block;"),t}if("complete"===document.readyState){var e=document.getElementById("screen"),n=document.getElementById("showPoint"),i=document.getElementById("randomColorToggler"),a=document.getElementById("restart"),s=document.getElementById("pauseToggler"),c={up:document.getElementById("up"),down:document.getElementById("down"),left:document.getElementById("left"),right:document.getElementById("right")},l=document.getElementById("dialog"),d=document.getElementById("rate"),u=t();if(u!==!1){var h=new r(e,n,u,l,d);h.listenEvent(i,a,s,c)}}}},function(t,e,n){"use strict";function r(t,e,n,r,o){this.size=n,this.screen=t,this.dialog=r,this.isStop=!1,this.row=22,this.col=14,this.oRate=o,this.count=0,this.showPoint=e,this.currRate=0,this.randomColor=!1,this.screenArray=this.init(this.row,this.col),this.addUnit(),this.stop=this.run()}var o=n(2),i=n(3),a=n(4);r.currUnit=null,r.prototype={init:function(t,e){for(var n=[],r=0;r<t;++r)for(var o=0;o<e;++o)n[r*e+o]=r===t-1||0===o||o===e-1||0===r?1:0;return new i(t,e,n)},addUnit:function(){var t=["i","z","s","l","j","t","o"][o.randi(0,6)],e={row:0,col:o.randi(1,9)};r.currUnit=new a(e),r.currUnit.init(this.screen,t,this.randomColor&&o.randomColor()+",0.5",this.size,this.row,this.col)},getAbsPosData:function(){return r.currUnit.getAbsPosData(this.row,this.col)},render:function(t,e){var n=this.size,i=0,a=r.currUnit.dom.getElementsByTagName("div");if("top"===e)for(;i<t.length;++i)o.setStyles(a[i],"top:"+t[i].row*n+"px;");else if("left"===e)for(;i<t.length;++i)o.setStyles(a[i],"left:"+t[i].col*n+"px;");else if(void 0===e)for(;i<t.length;++i)o.setStyles(a[i],"left:"+t[i].col*n+"px;top:"+t[i].row*n+"px;")},messagebox:function(t){var e=this.dialog.getElementsByTagName("span")[0];e.innerHTML=t,o.setStyles(this.dialog,"visibility:visible;")},resetPos:function(t){var e=t.currUnit.dom,n=t.next||null,r=t._this,i=(r.size,r.getAbsPosData()),a=r.screenArray;if(r.check(i,1,0))return r.render(i),void++t.currUnit.wrapPos.row;if(a.rowInfo[0])return r.stop(),r.messagebox("Game over"),"Game is over!";for(var s=0;s<i.length;++s)a.set(i[s].row,i[s].col,1,e.getElementsByTagName("div")[s]);r.render(i);var c=r.checkPoint(),l=c.length;if(l>0){var d=o.max_array(c);r.modifyPos(l,d,c)}return t.currUnit.onkeypress=null,{done:!0,next:n}},modifyPos:function(t,e,n){var r=this.screenArray,i=r.rowInfo,a=r.row,s=this.size;for(var c in i)parseInt(c)<a&&(a=parseInt(c));for(var l,c=e;c>a-1;--c)l=Math.max(c-t,0),r.copy(c,l);for(var d in i){var u=parseInt(d,10);if(!(u>e||u<a)){Math.min(u+t,this.row-2);for(var c in i[d]){var h=parseFloat(o.getStyles(i[d][c],"top"));o.setStyles(i[d][c],"top:"+(h+t*s)+"px")}}}for(var p=e;p>a-1;--p)l=Math.max(p-t,0),i[l]?i[p]=i[l].slice():i[p]=0},checkPoint:function(){var t=this.screenArray,e=t.rowInfo,n=[];for(var r in e)if(e[r].length===t.col-2){for(var o in e[r]){var i=e[r][o].parentNode;i.removeChild(e[r][o])}var a=parseInt(r);n.push(a),this.showPoint.innerHTML="<p>"+12*++this.count+"</p>";var s=[10,100,300,600,1e3,2e3];if(12*this.count>s[this.currRate]){var c=++this.currRate,l=this.oRate.getElementsByTagName("label")[0],d=document.getElementById("progress");l.innerHTML="难度系数:<span>"+c+"</span>",d.setAttribute("value",10*c),this.messagebox('难度升级为:<span color="red">'+c+"</span>"),this.isStop||(this.stop(),this.isStop=!0)}this.count%4||this.clearDom()}return n},clearDom:function(){for(var t=this.screen,e=Array.prototype.slice.call(t.children),n=e.length,r=0;r<n;++r)e[r].hasChildNodes()||t.removeChild(e[r])},check:function(t,e,n){var r=this.screenArray;for(var o in t){var i=r.get(t[o].row+e,t[o].col+n);if(1===i)return!1}return!0},moveRight:function(t){var e=r.currUnit,n=this.getAbsPosData();if(this.check(n,0,-1))return--e.wrapPos.col,void this.render(n,"left")},moveLeft:function(t){var e=r.currUnit,n=this.getAbsPosData();if(this.check(n,0,1))return++e.wrapPos.col,void this.render(n,"left")},moveDown:function(t){var e=r.currUnit,n=this.getAbsPosData();if(this.check(n,1,0))return++e.wrapPos.row,void this.render(n,"top")},transform:function(){var t=r.currUnit.data.slice(),e=r.currUnit.transform();this.check(e,0,0)?this.render(e):r.currUnit.data=t},listenEvent:function(t,e,n,r){var i=this,a=i.dialog.getElementsByTagName("button")[0];window.onkeypress=function(t){var t=t||window.event,e=t.keyCode||t.charCode;switch(e){case 97:case 65:i.moveRight();break;case 119:case 87:i.transform();break;case 100:case 68:i.moveLeft();break;case 115:case 83:i.moveDown()}},a.onclick=function(){i.isStop&&(i.stop=i.run(),i.isStop=!1),o.setStyles(i.dialog,"visibility:hidden;")},r.up.onclick=function(){i.transform()},r.down.onclick=function(){i.moveDown()},r.left.onclick=function(){i.moveRight()},r.right.onclick=function(){i.moveLeft()},t.onclick=function(){i.randomColor=!i.randomColor,i.randomColor?this.innerHTML="随机色关":this.innerHTML="随机色开"},e.onclick=function(){o.isWeiXin()?location.reload():o.updateUrl(window.location.href)},n.onclick=function(){i.isStop?(i.stop=i.run(),i.isStop=!1,this.innerHTML="暂停"):(i.stop(),i.isStop=!0,this.innerHTML="继续")}},run:function(){var t=!0,e=this,n=function(){t=!0,e.addUnit()},i=[700,600,500,400,300,200],a=setInterval(function(){t===!0&&(t=!1,o.animation(i[e.currRate],e.resetPos,{currUnit:r.currUnit,_this:e,next:n}))},1);return function(){window.clearInterval(a),window.cancelAnimationFrame(o.animation.cancelAnimaId)}}},t.exports=r},function(t,e){"use strict";t.exports={getStyles:function(t,e){return window.getComputedStyle?window.getComputedStyle(t,null).getPropertyValue(e):window.currentStyle?window.currentStyle(t).getAttribute(e):void 0},setStyles:function(t,e){var n=t.style.cssText;t.style.cssText=";"===n.substr(-1,1)?n+e:n+";"+e},type:function(t){return Object.prototype.toString.call(t).split(" ")[1].slice(0,-1)},randf:function(t,e){return Math.random()*(e-t)+t},randi:function(t,e){return Math.round(this.randf(t,e))},max_array:function(t){var e=0;for(var n in t)t[n]>e&&(e=t[n]);return e},randomColor:function(){var t=this.randi(0,255),e=this.randi(0,255),n=this.randi(0,255);return t+","+e+","+n},getInner:function(){var t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;return{height:t,width:e}},isWeiXin:function(){var t=window.navigator.userAgent.toLowerCase();return"micromessenger"==t.match(/MicroMessenger/i)},updateUrl:function(t,e){var e=(e||"t")+"=",n=new RegExp(e+"\\d+");t=t.search(n)===-1?t+"?"+e+(new Date).getTime():t.replace(n,e+(new Date).getTime()),window.location.replace(t)},insertRule:function(t,e,n){if(t.insertRule){var r=e+"{"+n+"}";t.insertRule(r,t.cssRules.length)}else t.addRule&&t.addRule(e,n,t.rules.length)},animation:function(t,e,n){if("function"!=typeof e)throw new Error(e.toString()+"is not a function!");var t="Number"===this.type(t)?t:1e3,r=null,n="Object"===this.type(n)?n:{},o=null,i=0,a=this,s=function(c){null===o&&(o=c);var l=c-o;l-i>=t&&(i=l,r=e(n)),void 0==r?a.animation.cancelAnimaId=requestAnimationFrame(s):r.next&&"Function"===a.type(r.next)&&r.next()};requestAnimationFrame(s)}}},function(t,e){"use strict";function n(t,e,n){this.row=t,this.col=e,this.data=n,this.rowInfo={}}n.prototype={get:function(t,e){return this.check(t,e),this.data[t*this.col+e]},set:function(t,e,n,r){this.check(t,e),this.data[t*this.col+e]=n,void 0!==r&&(this.rowInfo[t]||(this.rowInfo[t]=[]),this.rowInfo[t].push(r))},copy:function(t,e){for(var n=this.col,r=0;r<n;++r)this.set(t,r,this.get(e,r))},map:function(t){var e,n,r=(this.data,this.row),o=this.col;for(e=0;e<r;++e)for(n=0;n<o;++n)t(this.get(e,n),e,n)},check:function(t,e){var n=t*this.col+e,r=this.data;if(n>r.length)throw new Error("get the data: ("+n+") is overflow rang:"+r.length)},dump:function(){for(var t=this.row,e=0,n=this.col,r=(this.data,0);r<t;++r){console.log(e++ +"_>.   __"+t+" | "+n);for(var o="",i="_",a=0;a<n;++a)o+=this.get(r,a)+" | ",i+="____";console.log(o),console.log(i)}}},t.exports=n},function(t,e,n){"use strict";function r(t,e,n){this.wrapPos=t,this.data=[]}var o=n(2),i=n(3),a={i:[{r:1,c:4,data:"1111"},{r:4,c:1,data:"1111"}],z:[{r:2,c:3,data:"110011"},{r:3,c:2,data:"011110"}],s:[{r:2,c:3,data:"011110"},{r:3,c:2,data:"101101"}],t:[{r:2,c:3,data:"111010"},{r:3,c:2,data:"011101"},{r:2,c:3,data:"010111"},{r:3,c:2,data:"101110"}],l:[{r:3,c:2,data:"101011"},{r:2,c:3,data:"111100"},{r:3,c:2,data:"110101"},{r:2,c:3,data:"001111"}],j:[{r:3,c:2,data:"010111"},{r:2,c:3,data:"100111"},{r:3,c:2,data:"111010"},{r:2,c:3,data:"111001"}],o:[{r:2,c:2,data:"1111"}]};r.prototype={init:function(t,e,n,r,i,s){var c=o.randi(0,a[e].length-1),l=a[e][c];this.pos;this.typeInfo={type:a[e],index:c},this.createUnits(t,l,n,r,i,s)},createUnits:function(t,e,n,r,o,a){var s=document.createElement("div");this.initPos(new i(e.r,e.c,e.data));for(var c=this.getAbsPosData(),l=c.length,d=0;d<l;++d){var u=this.createUnit(c[d],n,r);u.setAttribute("class","unit"),s.appendChild(u)}t.appendChild(s),this.dom=s},createUnit:function(t,e,n){var r=document.createElement("div");return o.setStyles(r,"left:"+t.col*n+"px;top:"+t.row*n+"px;background-color: rgba("+e+");"),r},getAbsPosData:function(t,e){var n=this.data,r=[],o=0,i=0;for(var a in n)o=Math.max(n[a].row+this.wrapPos.row-t-2,o),i=Math.max(n[a].col+this.wrapPos.col-e-2,i);i>0&&(this.wrapPos.col-=i),o>0&&(this.wrapPos.row-=o);for(var a in n)r.push({row:n[a].row+this.wrapPos.row,col:n[a].col+this.wrapPos.col});return r},initPos:function(t){var e=this;e.data.length=0,t.map(function(t,n,r){"1"===t&&e.data.push({row:n,col:r})})},transform:function(){var t=this.typeInfo.type,e=t.length,n=t[++this.typeInfo.index%e];return this.initPos(new i(n.r,n.c,n.data)),this.getAbsPosData()}},t.exports=r},function(t,e,n){var r=n(6);"string"==typeof r&&(r=[[t.id,r,""]]);n(8)(r,{});r.locals&&(t.exports=r.locals)},function(t,e,n){e=t.exports=n(7)(),e.push([t.id,'body{background:#ddd;margin:0;padding:0;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;-khtml-user-select:none;user-select:none}#dialog,#guide,button,div,footer{margin:0;padding:0;box-sizing:border-box;box-shadow:3px 5px 6px #888}#screen,#setting{height:100%}#gameWrap{position:relative;margin:0 auto;overflow:hidden;display:none}#screen{background:#f3f5f5;position:relative}#copyright{position:fixed;bottom:0;padding-top:1px;color:#666}#setting{width:98%;background-color:hsla(0,0%,96%,.5);position:absolute;right:0;top:0}#screen>div{position:relative}.unit{border:1px solid #369;border-radius:3px;background:rgba(167,240,206,.6)}#showPoint,.unit{position:absolute}#showPoint{right:0;top:20px;background:#444;text-align:center;color:gold;font-weight:700}#pauseToggler,#randomColorToggler,#restart{width:98%;position:relative;right:0;padding:0;background-color:rgba(220,0,0,.4);color:#fff}#copyright{font-size:12px;height:12px;margin:0 auto;text-align:center;color:#666;background-color:#f6f6f6;word-break:break-all;text-overflow:ellipsis;word-wrap:break-word;z-index:1}#guide{border:1px solid #ddd;position:relative;top:0;right:0;margin:0;padding:0;font-size:14px;list-style:none;z-index:2}.clearfix:after,.clearfix:before{display:table;content:" "}.clearfix:after{clear:both}#down,#left,#right,#up{float:left;color:#fff;width:25%}#dialog{width:70%;position:absolute;left:15%;background-color:#f6f6f6;border-top:5px solid rgba(220,0,0,.4);visibility:hidden;color:#666;text-align:center;vertical-align:middle}#dialog>button{position:absolute;width:50%;left:25%}#rate{position:absolute;font-size:10px}#rate>label{color:#888;width:98%;display:block;word-break:break-all;text-overflow:ellipsis;overflow:hidden}#rate>label>span{color:red}#progress{width:98%;height:10px}',""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<e.length;o++){var a=e[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(t,e,n){function r(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=p[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(l(r.parts[i],e))}else{for(var a=[],i=0;i<r.parts.length;i++)a.push(l(r.parts[i],e));p[r.id]={id:r.id,refs:1,parts:a}}}}function o(t){for(var e=[],n={},r=0;r<t.length;r++){var o=t[r],i=o[0],a=o[1],s=o[2],c=o[3],l={css:a,media:s,sourceMap:c};n[i]?n[i].parts.push(l):e.push(n[i]={id:i,parts:[l]})}return e}function i(t,e){var n=m(),r=y[y.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),y.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function a(t){t.parentNode.removeChild(t);var e=y.indexOf(t);e>=0&&y.splice(e,1)}function s(t){var e=document.createElement("style");return e.type="text/css",i(t,e),e}function c(t){var e=document.createElement("link");return e.rel="stylesheet",i(t,e),e}function l(t,e){var n,r,o;if(e.singleton){var i=w++;n=v||(v=s(e)),r=d.bind(null,n,i,!1),o=d.bind(null,n,i,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=c(e),r=h.bind(null,n),o=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(e),r=u.bind(null,n),o=function(){a(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}function d(t,e,n,r){var o=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=x(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}function u(t,e){var n=e.css,r=e.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function h(t,e){var n=e.css,r=e.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=t.href;t.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var p={},f=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},g=f(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),m=f(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,w=0,y=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=g()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var n=o(t);return r(n,e),function(t){for(var i=[],a=0;a<n.length;a++){var s=n[a],c=p[s.id];c.refs--,i.push(c)}if(t){var l=o(t);r(l,e)}for(var a=0;a<i.length;a++){var c=i[a];if(0===c.refs){for(var d=0;d<c.parts.length;d++)c.parts[d]();delete p[c.id]}}}};var x=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()}]);